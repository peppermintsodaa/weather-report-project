<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- import necessary scripts to parse csv file -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="jquery-csv.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WIL Project</title>
    <!-- import necessary css stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
</head>
<body onload="createSuburbOptions();">

<!--Header-->
<div class="header">
    <h1>Weather Insurances</h1>
</div>

<!--Navigation Bar-->
<div class="navigation-bar">
    <a href="HomePage.html">Home</a>
    <a href="Insurance.html">Insurance</a>
    <a href="WeatherPredictionPage.html">Weather Predictions</a>
    <a href="Roles.html">Our Roles</a>
</div>

<br>
<br>
<!--
<div class="sample-weather-prediction">
    <h1>Sample weather prediction output</h1>
    <p><b>image taken from website</b></p>
    <img src="images/weather-prediction.png" alt="Sample Weather prediction">
</div>

--> 

<!-- Main container -->
<div class="container">
    <!-- Main content area -->
    <div class="main-content">
        <h1>Weather Predictions of Suburb</h1>
        <p>Select a Date and Location Suburb in Australia to see the predicted average weather during that time and its susceptibility of a weather event.</p>

        <!-- Dropdown for months -->
        <div class="form-group">
            <label for="prediction-month">Select a Month:</label>
            <select id="prediction-month">
                <option value="January">January</option>
                <option value="February">February</option>
                <option value="March">March</option>
                <option value="April">April</option>
                <option value="May">May</option>
                <option value="June">June</option>
                <option value="July">July</option>
                <option value="August">August</option>
                <option value="September">September</option>
                <option value="October">October</option>
                <option value="November">November</option>
                <option value="December">December</option>
            </select>
        </div>

        <br>
        <!-- Input field for search -->
        <div class="form-group">
            <label for="suburbs">Select a Suburb:</label>
            <select id="suburbs"></select>
        </div>

        <br>
        <!-- Button -->
         <div class="output-button">
            <button onclick="calculateClaim()">Get Claim Amount</button>
        </div>

        <!-- Result display -->
        <div id="result">
            <p id="result-text">The predicted average weather in <u><i>suburb</i></u> in the month of <u><i>month</i></u> will be <u><i>averageTemp</i></u>&deg;C.</p><br>
            <p id="result-text">From this, <u><i>suburb</i></u> is not susceptible of a weather disaster during this month</p><br>
            <p id="result-text"> <u><i>or</i></u></p><br>
            <p class="red-text" id="result-text"><b><i>WARNING</i></b></p>
            <p class="red-text" id="result-text"><b><u><i>suburb</i></u> is susceptible of an <u><i>weather event</i></u> occurring </b></p><br>
            <p id="result-text"><b>What to do? Safety Measures:</b></p>
            <p id="result-text">.......</p>

        </div>
    </div>
</div>

<br>
<br>

<div class="footer">
    <h3>Our Website</h3> <br>
    <a href="HomePage.html">Home</a>
    <a href="Insurance.html">Insurance</a>
    <a href="WeatherPredictionPage.html">Weather Predictions</a>
    <a href="Roles.html">Our Roles</a>
</div>
</body>

<script>
    // note: you need to run the cors_http_server.py file to 
    // fetch the dataset via a local server
    async function getSuburbs(file) {
        let response = await fetch(file);
        let data = await response.text();
        let csv_final = await $.csv.toArrays(data);
        // extract the first column in the dataset without the headings
        let suburbs = await csv_final.map(e => e[0]).slice(1, -1);
        
        return suburbs
    }

    // get suburbs from dataset
    suburbs = getSuburbs('http://127.0.0.1:8000/datasets/SuburbClustered.csv');
    
    // Function to create all options for suburb drop down
    async function createSuburbOptions() {
        let select = document.getElementById("suburbs");
        
        // extract array from suburb promise
        await suburbs.then(value => 
            value.sort().forEach(suburb => {
                let option = document.createElement("option");
                option.textContent = suburb;
                option.value = suburb;
                select.appendChild(option);
        }));
    }

    // change suburbs to be searchable
    $(function() {
        $("#suburbs").select2();
    });
</script>

</html>